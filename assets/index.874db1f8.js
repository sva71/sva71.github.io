var I=Object.defineProperty;var w=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var y=(o,e,l)=>e in o?I(o,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[e]=l,b=(o,e)=>{for(var l in e||(e={}))O.call(e,l)&&y(o,l,e[l]);if(w)for(var l of w(e))S.call(e,l)&&y(o,l,e[l]);return o};import{A as x,a as c,r as n,c as V,b as p,d as s,w as d,o as k,e as D,f as U,t as T,g as r,h as B,V as P,p as A}from"./vendor.73e0c983.js";const L=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&u(f)}).observe(document,{childList:!0,subtree:!0});function l(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerpolicy&&(a.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?a.credentials="include":t.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function u(t){if(t.ep)return;t.ep=!0;const a=l(t);fetch(t.href,a)}};L();var M=(o,e)=>{const l=o.__vccOpts||o;for(const[u,t]of e)l[u]=t;return l};const R={components:{AgGridVue:x},data(){return{baseUrl:"https://tala.cloudi.es/routes/26bb36adfb",auth:{username:"warrior",password:"ArmyOfCyborgs"},columnDefs:[{headerName:"#",sortable:!0,field:"taskId",width:100},{headerName:"\u0410\u0432\u0442\u043E\u0440",sortable:!0,field:"authorPseudo",width:200},{headerName:"\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043E",sortable:!0,field:"ts"},{headerName:"\u041E\u043F\u0438\u0441",sortable:!0,field:"details"},{headerName:"\u041F\u043B\u0430\u0442\u0444\u043E\u0440\u043C\u0430",sortable:!0,field:"platform"},{headerName:"\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F",sortable:!0,field:"link",cellRenderer:o=>`<a href="${o.value}" target="_blank">link</a>`},{headerName:"\u0422\u0438\u043F",sortable:!0,field:"type"},{headerName:"\u0414\u043E\u0437\u0432\u0456\u043B",field:"enabled",editable:!1,cellRenderer:o=>`<input type='checkbox' disabled ${o.value?"checked":""} />`}],rowData:[],platforms:["facebook","twitter","telegram","president","change_org"],taskTypes:["petition","report"],modalShow:!1,deleteModalShow:!1,appending:!1,editing:!1,buf:{taskId:0,authorPseudo:"",details:"",platform:"",link:"",type:""},gridOptions:{}}},mounted(){this.readData()},methods:{readData(){c.get(this.baseUrl+"/tasks",{auth:this.auth}).then(o=>{this.online=!0;for(let e of o.data)this.rowData.push({taskId:e.taskID,authorPseudo:e.author.pseudo,ts:new Date(e.ts).toLocaleDateString()+" "+new Date(e.ts).toLocaleTimeString(),details:e.details,platform:e.platform,link:e.link,type:e.type,enabled:e.enabled})}).catch(o=>{console.error(o.message)}).finally(()=>this.gridOptions.api.sizeColumnsToFit())},append(){c.post(this.baseUrl+"/task",{details:this.buf.details,link:this.buf.link,platform:this.buf.platform,type:this.buf.type},{auth:this.auth}).then(o=>{this.buf.taskId=o.data.task.taskID,this.buf.authorPseudo=o.data.task.author.pseudo,this.buf.ts=o.data.task.ts,this.rowData.push(this.buf),this.gridOptions.api.setRowData(this.rowData),this.clearBuf()}).catch(o=>console.error(o.message))},edit(){c.put(this.baseUrl+"/task",{taskID:this.buf.taskId,details:this.buf.details,link:this.buf.link,platform:this.buf.platform,type:this.buf.type,enabled:this.buf.enabled},{auth:this.auth}).then(o=>{if(o.data.updated&&o.data.updated===1){let e=this.rowData.findIndex(l=>l.taskId===this.buf.taskId);this.rowData[e]=b({},this.buf),this.gridOptions.api.setRowData(this.rowData),this.clearBuf()}}).catch(o=>console.error(o.message))},delete(){c.delete(this.baseUrl+"/task",{auth:this.auth,data:{taskID:this.buf.taskId}}).then(o=>{if(o.data.archived&&o.data.archived===1){let l=this.gridOptions.api.getSelectedNodes()[0].data.taskId,u=this.rowData.findIndex(t=>t.taskId===l);this.rowData.splice(u,1),this.gridOptions.api.setRowData(this.rowData),this.clearBuf()}})},clearBuf(){this.buf={taskId:0,authorPseudo:"",details:"",platform:"",link:"",type:""}},gridClick(){let o=this.gridOptions.api.getSelectedNodes();o.length&&(this.buf.taskId=o[0].data.taskId)},createTaskClick(){this.clearBuf(),this.appending=!0,this.modalShow=!0},editTaskClick(){let o=this.gridOptions.api.getSelectedNodes();o.length&&(this.editing=!0,this.buf=b({},o[0].data),this.modalShow=!0)},modalOk(){this.appending&&this.append(),this.editing&&this.edit(),this.appending=!1,this.editing=!1},modalCancel(){this.appending=!1,this.editing=!1},deleteTaskClick(){this.gridOptions.api.getSelectedNodes().length&&(this.deleteModalShow=!0)},deleteModalOk(){this.delete()}}},E={class:"wrapper",id:"top"},F={class:"top-panel"},G=r("\u0421\u0442\u0432\u043E\u0440\u0438\u0442\u0438 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F"),q=r("\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438"),z=r("\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438"),K={key:0,class:"input-group"},j={style:{width:"20%"}},H=r("ID:"),J=p("div",{style:{width:"5%"}},null,-1),Q={style:{width:"75%"}},W=r("\u0410\u0432\u0442\u043E\u0440:"),X=r("\u041E\u043F\u0438\u0441:"),Y=r("\u041F\u043B\u0430\u0442\u0444\u043E\u0440\u043C\u0430:"),Z=r("\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F:"),$=r("\u0422\u0438\u043F:"),ee=r("\u0414\u043E\u0437\u0432\u0456\u043B");function te(o,e,l,u,t,a){const f=n("b-button"),h=n("b-form-text"),m=n("b-form-input"),v=n("b-form-textarea"),_=n("b-form-select"),C=n("b-form-checkbox"),g=n("b-modal"),N=n("ag-grid-vue");return k(),V("div",E,[p("div",F,[s(f,{variant:"success",onClick:a.createTaskClick},{default:d(()=>[G]),_:1},8,["onClick"]),s(f,{variant:"primary",onClick:a.editTaskClick},{default:d(()=>[q]),_:1},8,["onClick"]),s(f,{variant:"danger",onClick:a.deleteTaskClick},{default:d(()=>[z]),_:1},8,["onClick"])]),s(g,{id:"task-modal",title:"\u041D\u043E\u0432\u0435 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F",modelValue:t.modalShow,"onUpdate:modelValue":e[7]||(e[7]=i=>t.modalShow=i),onOk:a.modalOk,onCancel:a.modalCancel},{default:d(()=>[t.editing?(k(),V("div",K,[p("div",j,[s(h,null,{default:d(()=>[H]),_:1}),s(m,{modelValue:t.buf.taskId,"onUpdate:modelValue":e[0]||(e[0]=i=>t.buf.taskId=i),disabled:""},null,8,["modelValue"])]),J,p("div",Q,[s(h,null,{default:d(()=>[W]),_:1}),s(m,{modelValue:t.buf.authorPseudo,"onUpdate:modelValue":e[1]||(e[1]=i=>t.buf.authorPseudo=i),disabled:""},null,8,["modelValue"])])])):D("",!0),s(h,null,{default:d(()=>[X]),_:1}),s(v,{modelValue:t.buf.details,"onUpdate:modelValue":e[2]||(e[2]=i=>t.buf.details=i),placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043E\u043F\u0438\u0441 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F"},null,8,["modelValue"]),s(h,null,{default:d(()=>[Y]),_:1}),s(_,{options:t.platforms,modelValue:t.buf.platform,"onUpdate:modelValue":e[3]||(e[3]=i=>t.buf.platform=i)},null,8,["options","modelValue"]),s(h,null,{default:d(()=>[Z]),_:1}),s(m,{modelValue:t.buf.link,"onUpdate:modelValue":e[4]||(e[4]=i=>t.buf.link=i),placeholder:"\u0412\u043A\u0430\u0436\u0456\u0442\u044C \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u0440\u0435\u0441\u0443\u0440\u0441"},null,8,["modelValue"]),s(h,null,{default:d(()=>[$]),_:1}),s(_,{options:t.taskTypes,modelValue:t.buf.type,"onUpdate:modelValue":e[5]||(e[5]=i=>t.buf.type=i)},null,8,["options","modelValue"]),t.editing?(k(),U(C,{key:1,modelValue:t.buf.enabled,"onUpdate:modelValue":e[6]||(e[6]=i=>t.buf.enabled=i)},{default:d(()=>[ee]),_:1},8,["modelValue"])):D("",!0)]),_:1},8,["modelValue","onOk","onCancel"]),s(g,{id:"delete-confirm",title:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043D\u043D\u044F",modelValue:t.deleteModalShow,"onUpdate:modelValue":e[8]||(e[8]=i=>t.deleteModalShow=i),onOk:a.deleteModalOk},{default:d(()=>[p("p",null,"\u0412\u0438 \u0434\u0456\u0439\u0441\u043D\u043E \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F #"+T(t.buf.taskId)+"?",1)]),_:1},8,["modelValue","onOk"]),s(N,{style:{width:"100%",height:"calc(95vh - 60px)"},class:"ag-theme-alpine",rowSelection:"single","grid-options":t.gridOptions,columnDefs:t.columnDefs,rowData:t.rowData,onClick:a.gridClick,onDblclick:a.editTaskClick},null,8,["grid-options","columnDefs","rowData","onClick","onDblclick"])])}var oe=M(R,[["render",te]]);const le=B(oe).use(P).use(A);le.mount("#app");
