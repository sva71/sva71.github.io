var D=Object.defineProperty;var g=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var w=(t,e,s)=>e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,m=(t,e)=>{for(var s in e||(e={}))C.call(e,s)&&w(t,s,e[s]);if(g)for(var s of g(e))N.call(e,s)&&w(t,s,e[s]);return t};import{r as h,c as y,a as f,b as i,w as d,o as b,d as V,e as I,t as x,f as r,g as S,p as U}from"./vendor.584417f3.js";const T=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}};T();var B=(t,e)=>{const s=t.__vccOpts||t;for(const[n,o]of e)s[n]=o;return s};const P={data(){return{baseUrl:"https://tala.cloudi.es/routes/26bb36adfb",auth:{username:"warrior",password:"ArmyOfCyborgs"},gridOptions:{columnDefs:[{headerName:"#",sortable:!0,field:"taskId",width:100},{headerName:"\u0410\u0432\u0442\u043E\u0440",sortable:!0,field:"authorPseudo",width:200},{headerName:"\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043E",sortable:!0,field:"ts"},{headerName:"\u041E\u043F\u0438\u0441",sortable:!0,field:"details"},{headerName:"\u041F\u043B\u0430\u0442\u0444\u043E\u0440\u043C\u0430",sortable:!0,field:"platform"},{headerName:"\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F",sortable:!0,field:"link",cellRenderer:t=>`<a href="${t.value}" target="_blank">link</a>`},{headerName:"\u0422\u0438\u043F",sortable:!0,field:"type"},{headerName:"\u0414\u043E\u0437\u0432\u0456\u043B",field:"enabled",editable:!1,cellRenderer:t=>`<input type='checkbox' disabled ${t.value?"checked":""} />`}],rowData:[],rowSelection:"single",onCellClicked:()=>this.gridClick(),onCellDoubleClicked:()=>this.editTaskClick()},platforms:["facebook","twitter","telegram","president","change_org"],taskTypes:["petition","report","archived"],modalShow:!1,deleteModalShow:!1,appending:!1,editing:!1,buf:{taskId:0,authorPseudo:"",details:"",platform:"",link:"",type:""}}},mounted(){const t=document.querySelector("#myGrid");new agGrid.Grid(t,this.gridOptions),this.readData()},methods:{readData(){axios.get(this.baseUrl+"/tasks",{auth:this.auth}).then(t=>{this.online=!0;for(let e of t.data)this.gridOptions.rowData.push({taskId:e.taskID,authorPseudo:e.author.pseudo,ts:new Date(e.ts).toLocaleDateString()+" "+new Date(e.ts).toLocaleTimeString(),details:e.details,platform:e.platform,link:e.link,type:e.type,enabled:e.enabled});this.gridOptions.api.setRowData(this.gridOptions.rowData)}).catch(t=>{console.error(t.message)}).finally(()=>this.gridOptions.api.sizeColumnsToFit())},append(){axios.post(this.baseUrl+"/task",{details:this.buf.details,link:this.buf.link,platform:this.buf.platform,type:this.buf.type},{auth:this.auth}).then(t=>{this.buf.taskId=t.data.task.taskID,this.buf.authorPseudo=t.data.task.author.pseudo,this.buf.ts=t.data.task.ts,this.rowData.push(this.buf),this.gridOptions.api.setRowData(this.gridOptions.rowData),this.clearBuf()}).catch(t=>console.error(t.message))},edit(){axios.put(this.baseUrl+"/task",{taskID:this.buf.taskId,details:this.buf.details,link:this.buf.link,platform:this.buf.platform,type:this.buf.type,enabled:this.buf.enabled},{auth:this.auth}).then(t=>{if(t.data.updated&&t.data.updated===1){let e=this.rowData.findIndex(s=>s.taskId===this.buf.taskId);this.rowData[e]=m({},this.buf),this.gridOptions.api.setRowData(this.gridOptions.rowData),this.clearBuf()}}).catch(t=>console.error(t.message))},delete(){axios.delete(this.baseUrl+"/task",{auth:this.auth,data:{taskID:this.buf.taskId}}).then(t=>{if(t.data.archived&&t.data.archived===1){let s=this.gridOptions.api.getSelectedNodes()[0].data.taskId,n=this.rowData.findIndex(o=>o.taskId===s);this.rowData.splice(n,1),this.gridOptions.api.setRowData(this.gridOptions.rowData),this.clearBuf()}})},clearBuf(){this.buf={taskId:0,authorPseudo:"",details:"",platform:"",link:"",type:""}},gridClick(){let t=this.gridOptions.api.getSelectedNodes();t.length&&(this.buf.taskId=t[0].data.taskId)},createTaskClick(){this.clearBuf(),this.appending=!0,this.modalShow=!0},editTaskClick(){let t=this.gridOptions.api.getSelectedNodes();t.length&&(this.editing=!0,this.buf=m({},t[0].data),this.modalShow=!0)},modalOk(){this.appending&&this.append(),this.editing&&this.edit(),this.appending=!1,this.editing=!1},modalCancel(){this.appending=!1,this.editing=!1},deleteTaskClick(){this.gridOptions.api.getSelectedNodes().length&&(this.deleteModalShow=!0)},deleteModalOk(){this.delete()}}},L={class:"wrapper",id:"top"},M={class:"top-panel"},R=r("\u0421\u0442\u0432\u043E\u0440\u0438\u0442\u0438 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F"),A=r("\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438"),G=r("\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438"),q={key:0,class:"input-group"},E={style:{width:"20%"}},F=r("ID:"),z=f("div",{style:{width:"5%"}},null,-1),K={style:{width:"75%"}},j=r("\u0410\u0432\u0442\u043E\u0440:"),H=r("\u041E\u043F\u0438\u0441:"),J=r("\u041F\u043B\u0430\u0442\u0444\u043E\u0440\u043C\u0430:"),Q=r("\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F:"),W=r("\u0422\u0438\u043F:"),X=r("\u0414\u043E\u0437\u0432\u0456\u043B"),Y=f("div",{id:"myGrid",class:"ag-theme-alpine",style:{height:"calc(100vh - 60px)",width:"100%"}},null,-1);function Z(t,e,s,n,o,l){const u=h("b-button"),p=h("b-form-text"),c=h("b-form-input"),O=h("b-form-textarea"),k=h("b-form-select"),v=h("b-form-checkbox"),_=h("b-modal");return b(),y("div",L,[f("div",M,[i(u,{variant:"success",onClick:l.createTaskClick},{default:d(()=>[R]),_:1},8,["onClick"]),i(u,{variant:"primary",onClick:l.editTaskClick},{default:d(()=>[A]),_:1},8,["onClick"]),i(u,{variant:"danger",onClick:l.deleteTaskClick},{default:d(()=>[G]),_:1},8,["onClick"])]),i(_,{id:"task-modal",title:"\u041D\u043E\u0432\u0435 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F",modelValue:o.modalShow,"onUpdate:modelValue":e[7]||(e[7]=a=>o.modalShow=a),onOk:l.modalOk,onCancel:l.modalCancel},{default:d(()=>[o.editing?(b(),y("div",q,[f("div",E,[i(p,null,{default:d(()=>[F]),_:1}),i(c,{modelValue:o.buf.taskId,"onUpdate:modelValue":e[0]||(e[0]=a=>o.buf.taskId=a),disabled:""},null,8,["modelValue"])]),z,f("div",K,[i(p,null,{default:d(()=>[j]),_:1}),i(c,{modelValue:o.buf.authorPseudo,"onUpdate:modelValue":e[1]||(e[1]=a=>o.buf.authorPseudo=a),disabled:""},null,8,["modelValue"])])])):V("",!0),i(p,null,{default:d(()=>[H]),_:1}),i(O,{modelValue:o.buf.details,"onUpdate:modelValue":e[2]||(e[2]=a=>o.buf.details=a),placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043E\u043F\u0438\u0441 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F"},null,8,["modelValue"]),i(p,null,{default:d(()=>[J]),_:1}),i(k,{options:o.platforms,modelValue:o.buf.platform,"onUpdate:modelValue":e[3]||(e[3]=a=>o.buf.platform=a)},null,8,["options","modelValue"]),i(p,null,{default:d(()=>[Q]),_:1}),i(c,{modelValue:o.buf.link,"onUpdate:modelValue":e[4]||(e[4]=a=>o.buf.link=a),placeholder:"\u0412\u043A\u0430\u0436\u0456\u0442\u044C \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u0440\u0435\u0441\u0443\u0440\u0441"},null,8,["modelValue"]),i(p,null,{default:d(()=>[W]),_:1}),i(k,{options:o.taskTypes,modelValue:o.buf.type,"onUpdate:modelValue":e[5]||(e[5]=a=>o.buf.type=a)},null,8,["options","modelValue"]),o.editing?(b(),I(v,{key:1,modelValue:o.buf.enabled,"onUpdate:modelValue":e[6]||(e[6]=a=>o.buf.enabled=a)},{default:d(()=>[X]),_:1},8,["modelValue"])):V("",!0)]),_:1},8,["modelValue","onOk","onCancel"]),i(_,{id:"delete-confirm",title:"\u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043D\u043D\u044F",modelValue:o.deleteModalShow,"onUpdate:modelValue":e[8]||(e[8]=a=>o.deleteModalShow=a),onOk:l.deleteModalOk},{default:d(()=>[f("p",null,"\u0412\u0438 \u0434\u0456\u0439\u0441\u043D\u043E \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u0437\u0430\u0432\u0434\u0430\u043D\u043D\u044F #"+x(o.buf.taskId)+"?",1)]),_:1},8,["modelValue","onOk"]),Y])}var $=B(P,[["render",Z]]);const ee=S($).use(U);ee.mount("#app");
